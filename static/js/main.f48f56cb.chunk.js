(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{31:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),s=n.n(c),i=n(20),r=n.n(i),o=n(8),l=(n(31),n(24)),u=n(2),m=n(3),d=n.p+"static/media/burger.a46d5c1c.svg",j=n.p+"static/media/close_burger.3c2485ff.svg";var h=function(e){var t=e.email,n=e.isLogged,s=e.onLogout,i=Object(c.useState)(!1),r=Object(u.a)(i,2),l=r[0],h=r[1],b=function(e){h(!l)},_=l?"header__nav header__nav_active":"header__nav",p=l?"menu menu_active":"menu",f=l?"menu__item menu__item_active":"menu__item",O=l?"header__logo header__logo_active":"header__logo",x=l?"header__burger":"header__burger header__burger_active",v=l?"header__burger header__burger_active":"header__burger";return Object(a.jsxs)("header",{className:"header",children:[Object(a.jsx)("div",{className:O}),Object(a.jsx)("nav",{className:n?_:"",children:Object(a.jsx)("ul",{className:p,children:Object(a.jsxs)(m.d,{children:[Object(a.jsx)(m.b,{path:"/sign-up",children:Object(a.jsx)("li",{className:"menu__item",children:Object(a.jsx)(o.b,{className:"menu__link",to:"sign-in",children:"\u0412\u043e\u0439\u0442\u0438"})})}),Object(a.jsx)(m.b,{path:"/sign-in",children:Object(a.jsx)("li",{className:"menu__item",children:Object(a.jsx)(o.b,{className:"menu__link",to:"sign-up",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})})}),n?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("li",{className:f,children:t}),Object(a.jsx)("li",{className:f,children:Object(a.jsx)("span",{className:"menu__link",onClick:function(){h(!1),s()},children:"\u0412\u044b\u0439\u0442\u0438"})})]}):""]})})}),Object(a.jsxs)(m.b,{path:"/cards",children:[Object(a.jsx)("img",{src:d,className:x,alt:"\u0411\u0443\u0440\u0433\u0435\u0440",onClick:b}),Object(a.jsx)("img",{src:j,className:v,alt:"\u0411\u0443\u0440\u0433\u0435\u0440",onClick:b})]})]})};var b=function(e){return e.isOwn?Object(a.jsx)("button",{className:"element__delete",type:"button",onClick:e.handleDelete}):null},_=s.a.createContext();var p=function(e){var t=Object(c.useContext)(_),n=e.card.owner._id===t._id,s=e.card.likes.some((function(e){return e._id===t._id}))?"element__like element__like_active":"element__like";return Object(a.jsxs)("article",{className:"element",children:[Object(a.jsx)(b,{isOwn:n,handleDelete:function(){e.onCardDelete(e.card)}}),Object(a.jsx)("img",{src:e.card.link,alt:e.card.name,className:"element__image",onClick:function(){e.onCardClick(e.card)}}),Object(a.jsxs)("div",{className:"element__info",children:[Object(a.jsx)("h2",{className:"element__title",children:e.card.name}),Object(a.jsxs)("div",{className:"element__likes",children:[Object(a.jsx)("button",{className:s,type:"button",onClick:function(){e.onCardLike(e.card)}}),Object(a.jsx)("span",{className:"element__likes-amount",children:e.card.likes.length})]})]})]})};var f=function(e){var t=Object(c.useContext)(_);return Object(a.jsxs)("main",{className:"main page__main",children:[Object(a.jsxs)("section",{className:"profile main__profile",children:[Object(a.jsx)("div",{className:"profile__avatar",onClick:e.onEditAvatar,style:{backgroundImage:"url(".concat(t.avatar,")")},children:Object(a.jsx)("div",{className:"profile__overlay"})}),Object(a.jsxs)("div",{className:"profile__info",children:[Object(a.jsx)("h1",{className:"profile__name",children:t.name}),Object(a.jsx)("button",{className:"profile__edit-button",type:"button",onClick:e.onEditProfile}),Object(a.jsx)("p",{className:"profile__status",children:t.about})]}),Object(a.jsx)("button",{className:"profile__add-button",type:"button",onClick:e.onAddPlace})]}),Object(a.jsx)("section",{className:"elements",children:e.cards.map((function(t){return Object(a.jsx)(p,{card:t,onCardClick:e.onCardClick,onCardLike:e.handleCardLike,onCardDelete:e.handleCardDelete},t._id)}))})]})};var O=function(e){return Object(a.jsx)("section",{className:"popup popup_".concat(e.name," ").concat(e.isOpen?"popup_opened":""),children:Object(a.jsxs)("div",{className:"popup__container popup__container_theme_edit-form",children:[Object(a.jsx)("h2",{className:"popup__title",children:"".concat(e.title)}),Object(a.jsx)("form",{className:"form form_place",name:"".concat(e.name),onSubmit:e.onSubmit,noValidate:!0,children:e.children}),Object(a.jsx)("button",{className:"popup__close",type:"button",onClick:e.onClose})]})})};var x=function(e){var t=Object(c.useContext)(_),n=Object(c.useState)(t.name),s=Object(u.a)(n,2),i=s[0],r=s[1],o=Object(c.useState)(t.about),l=Object(u.a)(o,2),m=l[0],d=l[1];return Object(c.useEffect)((function(){r(t.name),d(t.about)}),[t]),Object(a.jsxs)(O,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"profile-edit",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:i,about:m})},children:[Object(a.jsx)("input",{value:i||"",onChange:function(e){r(e.target.value)},id:"profile-name",type:"text",className:"form__item form__item_el_name",name:"profile-name",required:!0,minLength:"2",maxLength:"40"}),Object(a.jsx)("span",{id:"profile-name-error",className:"form__item-error"}),Object(a.jsx)("input",{value:m||"",onChange:function(e){d(e.target.value)},id:"profile-status",type:"text",className:"form__item form__item_el_status",name:"profile-status",required:!0,minLength:"2",maxLength:"200"}),Object(a.jsx)("span",{id:"profile-status-error",className:"form__item-error"}),Object(a.jsx)("button",{className:"popup__button",type:"submit",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})};var v=function(e){var t=Object(c.useRef)();return Object(a.jsxs)(O,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatar-edit",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},children:[Object(a.jsx)("input",{ref:t,id:"avatar-link",type:"url",className:"form__item form__item_el_status",name:"avatar-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),Object(a.jsx)("span",{id:"avatar-link-error",className:"form__item-error"}),Object(a.jsx)("button",{className:"popup__button",type:"submit",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})};var g=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),s=n[0],i=n[1],r=Object(c.useState)(""),o=Object(u.a)(r,2),l=o[0],m=o[1];return Object(a.jsxs)(O,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"place-add",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddPlace({name:s,link:l})},children:[Object(a.jsx)("input",{id:"place-name",onChange:function(e){i(e.target.value)},type:"text",className:"form__item form__item_el_name",name:"place-name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,minLength:"2",maxLength:"30"}),Object(a.jsx)("span",{id:"place-name-error",className:"form__item-error"}),Object(a.jsx)("input",{id:"place-link",onChange:function(e){m(e.target.value)},type:"url",className:"form__item form__item_el_status",name:"place-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),Object(a.jsx)("span",{id:"place-link-error",className:"form__item-error"}),Object(a.jsx)("button",{className:"popup__button",type:"submit",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})},N=n(11),k=n(9);var C=function(e){var t=e.onLogin,n={email:"",password:""},s=Object(c.useState)(n),i=Object(u.a)(s,2),r=i[0],o=i[1],l=function(e){var t=e.target,n=t.name,a=t.value;o((function(e){return Object(k.a)(Object(k.a)({},e),{},Object(N.a)({},n,a))}))},m=function(){o(n)};return Object(a.jsxs)("div",{className:"auth",children:[Object(a.jsx)("h2",{className:"auth__title",children:"\u0412\u0445\u043e\u0434"}),Object(a.jsxs)("form",{onSubmit:function(e){e.preventDefault(),r.email&&r.password&&t(r).then(m)},className:"form form_theme_dark",autoComplete:"off",children:[Object(a.jsx)("input",{id:"email",name:"email",type:"email",value:r.email,onChange:l,className:"form__item form__item_theme_dark",placeholder:"Email"}),Object(a.jsx)("input",{id:"password",name:"password",type:"password",value:r.password,onChange:l,className:"form__item form__item_theme_dark",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),Object(a.jsx)("button",{type:"submit",className:"form__button",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})};var y=function(e){var t=e.onRegister,n={email:"",password:""},s=Object(c.useState)(n),i=Object(u.a)(s,2),r=i[0],l=i[1],m=function(e){var t=e.target,n=t.name,a=t.value;l((function(e){return Object(k.a)(Object(k.a)({},e),{},Object(N.a)({},n,a))}))},d=function(){l(n)};return Object(a.jsxs)("div",{className:"auth",children:[Object(a.jsx)("h2",{className:"auth__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(a.jsxs)("form",{onSubmit:function(e){e.preventDefault(),r.email&&r.password&&t(r).then(d)},className:"form form_theme_dark",autoComplete:"off",children:[Object(a.jsx)("input",{id:"email",name:"email",type:"email",value:r.email,onChange:m,className:"form__item form__item form__item_theme_dark",placeholder:"Email"}),Object(a.jsx)("input",{id:"password",name:"password",type:"password",value:r.password,onChange:m,className:"form__item form__item form__item_theme_dark",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),Object(a.jsx)("button",{type:"submit",className:"form__button",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(a.jsxs)("p",{className:"auth__alternate",children:["\u0423\u0436\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c? ",Object(a.jsx)(o.b,{className:"auth__link",to:"/sign-in",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})},S=n(25),w=function(e){var t=e.component,n=Object(S.a)(e,["component"]);return Object(a.jsx)(m.b,{children:function(){return!0===n.loggedIn?Object(a.jsx)(t,Object(k.a)({},n)):Object(a.jsx)(m.a,{to:"./sign-in"})}})},L=n.p+"static/media/success_true.1b6082f8.svg",U=n.p+"static/media/success_false.df8eddf6.svg";var E=function(e){return Object(a.jsx)("section",{className:"popup popup_tooltip ".concat(e.isOpen?"popup_opened":""),children:Object(a.jsxs)("div",{className:"popup__container popup__container_theme_tooltip",children:[Object(a.jsxs)("div",{className:"tooltip",children:[Object(a.jsx)("img",{src:e.success?L:U,alt:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438",className:"tooltip__image"}),Object(a.jsx)("p",{className:"tooltip__description",children:e.success?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."})]}),Object(a.jsx)("button",{className:"popup__close",type:"button",onClick:e.onClose})]})})};var P=function(e){return Object(a.jsx)("button",{className:"popup__button",type:"button",children:"\u0414\u0430"})};var T=function(e){return Object(a.jsx)("section",{className:"popup popup_lightbox ".concat(e.card?"popup_opened":""),children:Object(a.jsxs)("div",{className:"popup__container popup__container_theme_lightbox",children:[Object(a.jsxs)("div",{className:"lightbox",children:[Object(a.jsx)("img",{src:e.card?e.card.link:"#",alt:e.card?e.card.name:"",className:"lightbox__image"}),Object(a.jsx)("p",{className:"lightbox__title",children:e.card?e.card.name:""})]}),Object(a.jsx)("button",{className:"popup__close",type:"button",onClick:e.onClose})]})})};var A=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})},D="https://auth.nomoreparties.co",I=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))},J=n(22),q=n(23),F=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(J.a)(this,e),this._baseUrl=n,this._headers=a}return Object(q.a)(e,[{key:"_checkStatus",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getUserInfo",value:function(){var e=this,t=this._baseUrl+"/users/me";return fetch(t,{method:"GET",headers:this._headers}).then((function(t){return e._checkStatus(t)}))}},{key:"getInitialCards",value:function(){var e=this,t=this._baseUrl+"/cards";return fetch(t,{method:"GET",headers:this._headers}).then((function(t){return e._checkStatus(t)}))}},{key:"setUserProfile",value:function(e,t){var n=this,a=this._baseUrl+"/users/me";return fetch(a,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then((function(e){return n._checkStatus(e)}))}},{key:"addCard",value:function(e,t){var n=this,a=this._baseUrl+"/cards";return fetch(a,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then((function(e){return n._checkStatus(e)}))}},{key:"removeCard",value:function(e){var t=this,n="".concat(this._baseUrl,"/cards/").concat(e);return fetch(n,{method:"DELETE",headers:this._headers}).then((function(e){return t._checkStatus(e)}))}},{key:"addLike",value:function(e){var t=this,n="".concat(this._baseUrl,"/cards/likes/").concat(e);return fetch(n,{method:"PUT",headers:this._headers}).then((function(e){return t._checkStatus(e)}))}},{key:"removeLike",value:function(e){var t=this,n="".concat(this._baseUrl,"/cards/likes/").concat(e);return fetch(n,{method:"DELETE",headers:this._headers}).then((function(e){return t._checkStatus(e)}))}},{key:"setAvatar",value:function(e){var t=this,n=this._baseUrl+"/users/me/avatar";return fetch(n,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((function(e){return t._checkStatus(e)}))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-19",headers:{authorization:"3cf94fea-bd08-4b5d-9ccb-283ecc1d9d83","Content-Type":"application/json"}});var R=function(){var e=Object(c.useState)(!1),t=Object(u.a)(e,2),n=t[0],s=t[1],i=Object(c.useState)(!1),r=Object(u.a)(i,2),o=r[0],d=r[1],j=Object(c.useState)(!1),b=Object(u.a)(j,2),p=b[0],N=b[1],k=Object(c.useState)(!1),S=Object(u.a)(k,2),L=S[0],U=S[1],J=Object(c.useState)(!1),q=Object(u.a)(J,2),R=q[0],B=q[1],G=Object(c.useState)(!1),z=Object(u.a)(G,2),H=z[0],M=z[1],V=Object(c.useState)(""),K=Object(u.a)(V,2),Q=K[0],W=K[1],X=Object(c.useState)(null),Y=Object(u.a)(X,2),Z=Y[0],$=Y[1],ee=Object(c.useState)({}),te=Object(u.a)(ee,2),ne=te[0],ae=te[1],ce=Object(c.useState)([]),se=Object(u.a)(ce,2),ie=se[0],re=se[1],oe=Object(m.g)(),le=Object(c.useCallback)((function(){var e=localStorage.getItem("jwt");e&&function(e){return fetch("".concat(D,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(I)}(e).then((function(e){e&&(M(!0),W(e.data.email),oe.push("/cards"))})).catch((function(){return oe.push("/sign-in")}))}),[oe]);function ue(){s(!1),d(!1),N(!1),$(null),U(!1)}return Object(c.useEffect)((function(){le()}),[]),Object(c.useEffect)((function(){F.getInitialCards().then((function(e){re(e)})).catch((function(e){console.log(e)}))}),[]),Object(c.useEffect)((function(){F.getUserInfo().then((function(e){ae(e)})).catch((function(e){console.log(e)}))}),[]),Object(a.jsx)("div",{className:"root",children:Object(a.jsxs)(_.Provider,{value:ne,children:[Object(a.jsxs)("div",{className:"page",children:[Object(a.jsx)(h,{email:Q,isLogged:H,onLogout:function(){localStorage.removeItem("jwt"),W(""),M(!1),oe.push("/sign-in")}}),Object(a.jsxs)(m.d,{children:[Object(a.jsx)(m.b,{path:"/sign-up",children:Object(a.jsx)(y,{onRegister:function(e){return function(e,t){return fetch("".concat(D,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(I)}(e.email,e.password).then((function(e){return B(!0),U(!0),oe.push("/sign-in"),e})).catch((function(e){U(!0),console.log(e)}))}})}),Object(a.jsx)(m.b,{path:"/sign-in",children:Object(a.jsx)(C,{onLogin:function(e){var t=e.email,n=e.password;return function(e,t){return fetch("".concat(D,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(I)}(t,n).then((function(e){e.token&&(W(t),M(!0),localStorage.setItem("jwt",e.token),oe.push("/cards"))})).catch((function(e){console.log(e)}))}})}),Object(a.jsx)(w,{path:"/cards",loggedIn:H,component:f,onEditProfile:function(e){s(!0)},onAddPlace:function(e){d(!0)},onEditAvatar:function(e){N(!0)},onCardClick:function(e){$(e)},cards:ie,handleCardLike:function(e){(e.likes.some((function(e){return e._id===ne._id}))?F.removeLike(e._id):F.addLike(e._id)).then((function(t){var n=ie.map((function(n){return n._id===e._id?t:n}));re(n)})).catch((function(e){console.log(e)}))},handleCardDelete:function(e){F.removeCard(e._id).then((function(){var t=ie.filter((function(t){return!(t._id===e._id)}));re(t)})).catch((function(e){console.log(e)}))}}),Object(a.jsx)(m.b,{children:H?Object(a.jsx)(m.a,{to:"/cards"}):Object(a.jsx)(m.a,{to:"/sign-in"})})]}),Object(a.jsx)(A,{})]}),Object(a.jsx)(x,{isOpen:n,onClose:ue,onUpdateUser:function(e){F.setUserProfile(e.name,e.about).then((function(e){ae(e),ue()})).catch((function(e){console.log(e)}))}}),Object(a.jsx)(v,{isOpen:p,onClose:ue,onUpdateAvatar:function(e){F.setAvatar(e.avatar).then((function(e){ae(e),ue()})).catch((function(e){console.log(e)}))}}),Object(a.jsx)(g,{isOpen:o,onClose:ue,onAddPlace:function(e){F.addCard(e.name,e.link).then((function(e){re([e].concat(Object(l.a)(ie))),ue()})).catch((function(e){console.log(e)}))}}),Object(a.jsx)(O,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"place-remove",children:Object(a.jsx)(P,{})}),Object(a.jsx)(T,{card:Z,onClose:ue}),Object(a.jsx)(E,{isOpen:L,onClose:ue,success:R})]})})},B=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,38)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),s(e),i(e)}))};r.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(o.a,{children:Object(a.jsx)(R,{})})}),document.getElementById("root")),B()}},[[37,1,2]]]);
//# sourceMappingURL=main.f48f56cb.chunk.js.map